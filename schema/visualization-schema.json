{
  "title": "Visualization Schema",
  "oneOf": [
    { "$ref": "#/$defs/visualization" },
    { "$ref": "#/$defs/layout" }
  ],
  "$defs": {
    "visualization": {
      "type": "object",
      "properties": {
        "type": { "const": "visualization" },
        "mark": { "enum": ["bar", "line", "point", "area"] },
        "encoding": {
          "type": "object",
          "properties": {
            "x": { "type": "string" },
            "y": { "type": "string" },
            "color": { "type": "string" }
          },
          "minProperties": 1,              
          "anyOf": [                       
            { "required": ["x"] },
            { "required": ["y"] }
          ],
          "additionalProperties": false
        }
      },
      "required": ["type", "mark", "encoding"],
      "additionalProperties": false       
    },
    "layout": {
      "type": "object",
      "properties": {
        "type": { "const": "layout" },
        "direction": { "enum": ["vertical", "horizontal"] },
        "gap": { "type": "string" },
        "children": {
          "type": "array",
          "minItems": 1,                  
          "items": { "oneOf": [
            { "$ref": "#/$defs/visualization" },
            { "$ref": "#/$defs/layout" }
          ]}
        }
      },
      "required": ["type", "direction", "gap", "children"],
      "additionalProperties": false       
    }
  }
}
